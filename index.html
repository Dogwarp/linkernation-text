<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>リンカーネイション Firebase デモ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<h1>リンカーネイション 投稿ログデモ</h1>

<!-- 投稿フォーム -->
<form id="postForm">
  <input type="text" id="postInput" placeholder="ここに書く" required>
  <button type="submit">投稿</button>
</form>

<!-- 投稿表示 -->
<ul id="postList"></ul>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-database.js";

  // Firebase 設定
  const firebaseConfig = {
    apiKey: "AIzaSyDdLmTIEgU3WNEN0Pr4fFNpQKjcYsmUXU8",
    authDomain: "linkernation-online.firebaseapp.com",
    projectId: "linkernation-online",
    databaseURL: "https://linkernation-online-default-rtdb.firebaseio.com/",
    storageBucket: "linkernation-online.appspot.com",
    messagingSenderId: "398889265909",
    appId: "1:398889265909:web:33f569fc04e98350d6b3bc",
    measurementId: "G-BH272B3F45"
  };

  // Firebase 初期化
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const postForm = document.getElementById("postForm");
  const postInput = document.getElementById("postInput");
  const postList = document.getElementById("postList");

  // 投稿フォーム送信
  postForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const text = postInput.value.trim();
    if (text.length === 0) return;
    push(ref(db, "posts"), {
      content: text,
      timestamp: Date.now()
    });
    postInput.value = "";
  });

  // データベースからリアルタイム取得
  const postsRef = ref(db, "posts");
  onValue(postsRef, (snapshot) => {
    postList.innerHTML = "";
    snapshot.forEach((childSnapshot) => {
      const post = childSnapshot.val();
      const li = document.createElement("li");
      li.textContent = post.content;
      postList.appendChild(li);
    });
  });
</script>
</body>
</html>
